!function(){"use strict";function e(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function t(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var n=function(){function n(t,r){var o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),this._inputSelector=t.inputSelector,this._submitButtonSelector=t.submitButtonSelector,this._inactiveButtonClass=t.inactiveButtonClass,this._inputErrorClass=t.inputErrorClass,this._errorClass=t.errorClass,this._inputList=function(t){if(Array.isArray(t))return e(t)}(o=r.querySelectorAll(t.inputSelector))||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(o)||function(t,n){if(t){if("string"==typeof t)return e(t,n);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?e(t,n):void 0}}(o)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),this._buttonEl=r.querySelector(t.submitButtonSelector),this._formElement=r}var r,o;return r=n,(o=[{key:"_showInputError",value:function(e){var t=this._formElement.querySelector("#".concat(e.id,"-error"));e.classList.add(this._inputErrorClass),t.textContent=e.validationMessage,t.classList.add(this._errorClass)}},{key:"_hideInputError",value:function(e){var t=this._formElement.querySelector("#".concat(e.id,"-error"));e.classList.remove(this._inputErrorClass),t.textContent="",t.classList.remove(this._errorClass)}},{key:"_checkInputValidity",value:function(e){e.validity.valid?this._hideInputError(e):this._showInputError(e)}},{key:"toggleButtonState",value:function(){this._inputList.every((function(e){return e.validity.valid}))?(this._buttonEl.classList.remove(this._inactiveButtonClass),this._buttonEl.disabled=!1):(this._buttonEl.classList.add(this._inactiveButtonClass),this._buttonEl.disabled=!0)}},{key:"_setupEventListeners",value:function(){var e=this;this.toggleButtonState(),this._inputList.forEach((function(t){t.addEventListener("input",(function(n){e._checkInputValidity(t),e.toggleButtonState()}))}))}},{key:"enableValidation",value:function(){this._formElement.addEventListener("submit",(function(e){e.preventDefault()})),this._setupEventListeners()}},{key:"resetValidation",value:function(){var e=this;this.toggleButtonState(),this._inputList.forEach((function(t){e._hideInputError(t)}))}}])&&t(r.prototype,o),Object.defineProperty(r,"prototype",{writable:!1}),n}();function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var i=function(){function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),o(this,"_handleEscUp",(function(e){"Escape"===e.key&&n.close()})),o(this,"_mouseClick",(function(e){e.target===n._popupElement&&n.close()})),this._popupElement=document.querySelector(t),this._handleEscUp=this._handleEscUp.bind(this)}var t,n;return t=e,(n=[{key:"setEventListeners",value:function(){var e=this;this._popupElement.querySelector(".popup__close-button").addEventListener("click",(function(){e.close()}))}},{key:"open",value:function(){this._popupElement.classList.add("popup_opened"),document.addEventListener("keyup",this._handleEscUp),document.addEventListener("mousedown",this._mouseClick)}},{key:"close",value:function(){this._popupElement.classList.remove("popup_opened"),document.removeEventListener("keyup",this._handleEscUp),document.removeEventListener("mousedown",this._mouseClick)}}])&&r(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function a(e){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a(e)}function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function c(){return c="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=s(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},c.apply(this,arguments)}function s(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=f(e)););return e}function l(e,t){return l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},l(e,t)}function p(e,t){if(t&&("object"===a(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function f(e){return f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},f(e)}var d=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&l(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=f(r);if(o){var n=f(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return p(this,e)});function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=i.call(this,e))._previewImage=t._popupElement.querySelector(".popup__image"),t._previewImageTitle=t._popupElement.querySelector(".popup__caption"),t}return t=a,(n=[{key:"open",value:function(e){this._previewImage.src=e.image,this._previewImage.alt="Photo of ".concat(e.title),this._previewImageTitle.textContent=e.title,c(f(a.prototype),"open",this).call(this)}}])&&u(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),a}(i);function h(e){return h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},h(e)}function y(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _(e,t){return _=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},_(e,t)}function v(e,t){if(t&&("object"===h(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return m(e)}function m(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function b(){return b="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=S(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},b.apply(this,arguments)}function S(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=E(e)););return e}function E(e){return E=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},E(e)}var g=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=E(r);if(o){var n=E(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return v(this,e)});function a(e){var t,n,r,o,u,c=e.popupSelector,s=e.handleFormSubmit;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),u=function(){n._form.addEventListener("submit",n._handleFormSubmit),b((t=m(n),E(a.prototype)),"setEventListeners",t).call(t)},(o="setEventListeners")in(r=m(n=i.call(this,c)))?Object.defineProperty(r,o,{value:u,enumerable:!0,configurable:!0,writable:!0}):r[o]=u,n._form=n._popupElement.querySelector(".popup__form"),n._inputList=n._popupElement.querySelectorAll(".popup__input"),n._submitButton=n._popupElement.querySelector(".popup__save-button"),n._handleFormSubmit=s,n}return t=a,(n=[{key:"getInputValues",value:function(){var e={};return this._inputList.forEach((function(t){e[t.name]=t.value})),e}},{key:"close",value:function(){b(E(a.prototype),"close",this).call(this),this._form.reset()}}])&&y(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),a}(i);function w(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function k(e,t,n){return t&&w(e.prototype,t),n&&w(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function O(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var C=k((function e(t){var n=this,r=t.nameSelector,o=t.descriptionSelector,i=t.avatarSelector;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),O(this,"getUserInfo",(function(){return{name:n._name.textContent,description:n._description.textContent,avatar:n._avatar.src}})),O(this,"setUserInfo",(function(e){var t=e.name,r=e.description;n._name.textContent=t,n._description.textContent=r,n._avatar.src=avatar})),this._name=document.querySelector(r),this._description=document.querySelector(o),this._avatar=document.querySelector(i)})),j={inputSelector:".popup__input",submitButtonSelector:".popup__save-button",inactiveButtonClass:"popup__save-button_type_disabled",inputErrorClass:"popup__input_type_error",errorClass:"popup__error_visible"},P=(document.querySelector(".popup_type_add"),{editModal:".popup_type_edit",nameSelector:".profile__name",descriptionSelector:".profile__description",editButton:document.querySelector(".profile__edit-button"),closeButton:document.querySelector(".popup__close-button")}),L=(document.querySelector(".profile__avatar"),document.querySelector(".modal_type_avatar .modal__form"),document.querySelector("#avatar-input"),{addModal:".popup_type_add",addButton:document.querySelector(".profile__add-button"),closeButton:document.querySelector(".popup__close-button")});function U(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var q=function(){function e(t){var n=t.baseUrl,r=t.headers;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._baseUrl=n,this._headers=r}var t,n;return t=e,(n=[{key:"_checkResponse",value:function(e){return e.ok?e.json():Promise.reject("Error ".concat(e.status))}},{key:"getAppInfo",value:function(){return Promise.all([this.getCardList(),this.getUserInfo()])}},{key:"getInitialCards",value:function(){return fetch("".concat(this._baseUrl,"/cards"),{headers:this._headers}).then(this._checkResponse)}},{key:"getUserInfo",value:function(){return fetch("".concat(this._baseUrl,"/users/me"),{headers:this._headers}).then(this._checkResponse)}},{key:"setUserInfo",value:function(e){var t=e.name,n=e.about;return fetch("".concat(this._baseUrl,"/users/me"),{method:"PATCH",headers:this._headers,body:JSON.stringify({name:t,about:n})}).then(this._checkResponse)}},{key:"addCard",value:function(e){var t=e.name,n=e.link;return fetch("".concat(this._baseUrl,"/cards"),{method:"POST",headers:this._headers,body:JSON.stringify({name:t,link:n})}).then(this._checkResponse)}},{key:"removeCard",value:function(e){return fetch("".concat(this._baseUrl,"/cards/").concat(e),{method:"DELETE",headers:this._headers}).then(this._checkResponse)}},{key:"addLike",value:function(e){return fetch("".concat(this._baseUrl,"/cards/likes/").concat(e),{method:"PUT",headers:this._headers}).then(this._checkResponse)}},{key:"removeLike",value:function(e){return fetch("".concat(this._baseUrl,"/cards/likes/").concat(e),{method:"DELETE",headers:this._headers}).then(this._checkResponse)}},{key:"setUserAvatar",value:function(e){var t=e.avatar;return fetch("".concat(this._baseUrl,"/users/me/avatar"),{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:t})}).then(this._checkResponse)}}])&&U(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}(),I=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=document.querySelector(e).querySelector(".popup__save-button");n.textContent=t?"Saving...":"Save"},R=new C({nameSelector:P.nameSelector,descriptionSelector:P.descriptionSelector,avatarSelector:".profile__image"});new d(".popup_type_preview").setEventListeners();var B=new g({popupSelector:".popup_type_edit",handleFormSubmit:function(e){I(".popup_type_edit",!0),D.getUserInfo({name:e.profileName,about:e.profileDescription}).then((function(e){R.setUserInfo({profileName:e.name,profileDescription:e.about}),B.closeModal()})).catch((function(e){return console.warn("Unable to update profile information: ".concat(e))})).finally((function(){I(".popup_type_edit")}))}}),T=new g({popupSelector:".popup_type_add",handleFormSubmit:function(e){I(".popup_type_add",!0),D.addCard(e).then((function(e){cardSection.addItem(createCard(e)),T.closeModal(),console.log(e)})).catch((function(e){return console.error("Unable to add a card: ".concat(e))})).finally((function(){I(".popup_type_add")}))}});B.setEventListeners(),T.setEventListeners();var A=document.querySelector("#owner-name"),x=document.querySelector("#owner-description"),D=new q({baseUrl:"https://around.nomoreparties.co/v1/group-12",headers:{authorization:"acca9dd3-a6a4-4626-88e2-60619602bdf9","Content-Type":"application/json"}});P.editButton.addEventListener("click",(function(){var e,t,n;t=(e=R.getUserInfo()).name,n=e.description,A.value=t,x.value=n,B.open()})),L.addButton.addEventListener("click",(function(){T.open()}));var V=document.querySelector(".popup_type_edit"),M=document.querySelector(".popup_type_add");new n(j,V).enableValidation(),new n(j,M).enableValidation()}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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U0FBQ0MsR0FBRCxPQUFTQyxRQUFRVSxNQUFSLGdDQUF1Q1gsT0FDdERHLFNBQVEsV0FDUGhCLEVBQWMseUJBK0R0QkssRUFBU0Qsb0JBQ1RhLEVBQVFiLG9CQWNSLElBQU1xQixFQUFZekYsU0FBUy9CLGNBQWMsZUFDbkN5SCxFQUFtQjFGLFNBQVMvQixjQUFjLHNCQUUxQ3FHLEVBQU0sSUFBSTlCLEVBQUksQ0FDbEJDLFFBQVMsOENBQ1RDLFFBQVMsQ0FDUGlELGNBQWUsdUNBQ2YsZUFBZ0Isc0JBUXBCMUQsRUFBY0UsV0FBV2hELGlCQUFpQixTQUFTLFdBeEJuRCxJQUNFLEVBQVFpQyxFQUFNUSxFQUFOUixHQUFSLEVBQThCK0MsRUFBU2QsZUFBL0JqQyxLQUFNUSxFQUFkLEVBQWNBLFlBQ2Q2RCxFQUFVcEUsTUFBUUQsRUFDbEJzRSxFQUFpQnJFLE1BQVFPLEVBdUJ6QnlDLEVBQVN1QixVQUtYdkQsRUFBYUUsVUFBVXBELGlCQUFpQixTQUFTLFdBQy9DOEYsRUFBUVcsVUFPVixJQUFNQyxFQUFhN0YsU0FBUy9CLGNBQWMsb0JBQ3BDNkgsRUFBWTlGLFNBQVMvQixjQUFjLG1CQUVmLElBQUlqQixFQUFjZ0YsRUFBd0I2RCxHQUNsREUsbUJBRU8sSUFBSS9JLEVBQWNnRixFQUF3QjhELEdBQ2xEQyxtQiIsInNvdXJjZXMiOlsid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9Qb3B1cC5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL1VzZXJJbmZvLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvdXRpbHMvY29uc3RhbnRzLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9BcGkuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy91dGlscy91dGlscy5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL3BhZ2VzL2luZGV4LmpzIl0sInNvdXJjZXNDb250ZW50IjpbImNsYXNzIEZvcm1WYWxpZGF0b3Ige1xyXG4gICAgY29uc3RydWN0b3Ioc2V0dGluZ3MsIGZvcm1FbGVtZW50KSB7XHJcbiAgICAgICAgdGhpcy5faW5wdXRTZWxlY3RvciA9IHNldHRpbmdzLmlucHV0U2VsZWN0b3I7XHJcbiAgICAgICAgdGhpcy5fc3VibWl0QnV0dG9uU2VsZWN0b3IgPSBzZXR0aW5ncy5zdWJtaXRCdXR0b25TZWxlY3RvcjtcclxuICAgICAgICB0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzID0gc2V0dGluZ3MuaW5hY3RpdmVCdXR0b25DbGFzcztcclxuICAgICAgICB0aGlzLl9pbnB1dEVycm9yQ2xhc3MgPSBzZXR0aW5ncy5pbnB1dEVycm9yQ2xhc3M7XHJcbiAgICAgICAgdGhpcy5fZXJyb3JDbGFzcyA9IHNldHRpbmdzLmVycm9yQ2xhc3M7XHJcbiAgICAgICAgdGhpcy5faW5wdXRMaXN0ID0gWy4uLmZvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoc2V0dGluZ3MuaW5wdXRTZWxlY3RvcildO1xyXG4gICAgICAgIHRoaXMuX2J1dHRvbkVsID0gZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihzZXR0aW5ncy5zdWJtaXRCdXR0b25TZWxlY3Rvcik7XHJcbiAgICAgICAgdGhpcy5fZm9ybUVsZW1lbnQgPSBmb3JtRWxlbWVudDtcclxuICAgIH1cclxuXHJcbiAgICBfc2hvd0lucHV0RXJyb3IoaW5wdXRFbCkge1xyXG4gICAgICAgIGNvbnN0IGVycm9yRWwgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKGAjJHtpbnB1dEVsLmlkfS1lcnJvcmApO1xyXG4gICAgICAgIGlucHV0RWwuY2xhc3NMaXN0LmFkZCh0aGlzLl9pbnB1dEVycm9yQ2xhc3MpO1xyXG4gICAgICAgIGVycm9yRWwudGV4dENvbnRlbnQgPSBpbnB1dEVsLnZhbGlkYXRpb25NZXNzYWdlO1xyXG4gICAgICAgIGVycm9yRWwuY2xhc3NMaXN0LmFkZCh0aGlzLl9lcnJvckNsYXNzKTtcclxuICAgIH1cclxuXHJcbiAgICBfaGlkZUlucHV0RXJyb3IoaW5wdXRFbCkge1xyXG4gICAgICAgIGNvbnN0IGVycm9yRWwgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKGAjJHtpbnB1dEVsLmlkfS1lcnJvcmApO1xyXG4gICAgICAgIGlucHV0RWwuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbnB1dEVycm9yQ2xhc3MpO1xyXG4gICAgICAgIGVycm9yRWwudGV4dENvbnRlbnQgPSAnJztcclxuICAgICAgICBlcnJvckVsLmNsYXNzTGlzdC5yZW1vdmUodGhpcy5fZXJyb3JDbGFzcyk7XHJcbiAgICB9XHJcblxyXG4gICAgX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsKSB7XHJcbiAgICAgICAgaWYgKCFpbnB1dEVsLnZhbGlkaXR5LnZhbGlkKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX3Nob3dJbnB1dEVycm9yKGlucHV0RWwpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0RWwpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICB0b2dnbGVCdXR0b25TdGF0ZSgpIHtcclxuICAgICAgICBjb25zdCBhbGxWYWxpZCA9IHRoaXMuX2lucHV0TGlzdC5ldmVyeSgoaW5wdXRFbCkgPT4gaW5wdXRFbC52YWxpZGl0eS52YWxpZCk7XHJcbiAgICAgICAgaWYgKGFsbFZhbGlkKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2J1dHRvbkVsLmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbiAgICAgICAgICAgIHRoaXMuX2J1dHRvbkVsLmRpc2FibGVkID0gZmFsc2U7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5fYnV0dG9uRWwuY2xhc3NMaXN0LmFkZCh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcclxuICAgICAgICAgICAgdGhpcy5fYnV0dG9uRWwuZGlzYWJsZWQgPSB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBfc2V0dXBFdmVudExpc3RlbmVycygpIHtcclxuICAgICAgICB0aGlzLnRvZ2dsZUJ1dHRvblN0YXRlKCk7XHJcbiAgICAgICAgdGhpcy5faW5wdXRMaXN0LmZvckVhY2goKGlucHV0RWwpID0+IHtcclxuICAgICAgICAgICAgaW5wdXRFbC5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgKGUpID0+IHtcclxuXHJcbiAgICAgICAgICAgICAgICB0aGlzLl9jaGVja0lucHV0VmFsaWRpdHkoaW5wdXRFbCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnRvZ2dsZUJ1dHRvblN0YXRlKCk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIGVuYWJsZVZhbGlkYXRpb24oKSB7XHJcbiAgICAgICAgdGhpcy5fZm9ybUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZXZ0KSA9PiB7XHJcbiAgICAgICAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICB0aGlzLl9zZXR1cEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgICB9XHJcblxyXG4gICAgcmVzZXRWYWxpZGF0aW9uKCkge1xyXG4gICAgICAgIHRoaXMudG9nZ2xlQnV0dG9uU3RhdGUoKTtcclxuXHJcbiAgICAgICAgdGhpcy5faW5wdXRMaXN0LmZvckVhY2goKGlucHV0RWxlbWVudCkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG59XHJcblxyXG5cclxuZXhwb3J0IGRlZmF1bHQgRm9ybVZhbGlkYXRvcjsiLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cCB7XHJcbiAgICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yKSB7XHJcbiAgICAgICAgdGhpcy5fcG9wdXBFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihwb3B1cFNlbGVjdG9yKTtcclxuICAgICAgICB0aGlzLl9oYW5kbGVFc2NVcCA9IHRoaXMuX2hhbmRsZUVzY1VwLmJpbmQodGhpcyk7XHJcbiAgICB9XHJcblxyXG4gICAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICAgICAgY29uc3QgY2xvc2VCdXR0b24gPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcignLnBvcHVwX19jbG9zZS1idXR0b24nKTtcclxuICAgICAgICBjbG9zZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcclxuICAgICAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgICAgICB9KTtcclxuICAgICAgfSAgICBcclxuXHJcbiAgICBvcGVuKCkge1xyXG4gICAgICAgIHRoaXMuX3BvcHVwRWxlbWVudC5jbGFzc0xpc3QuYWRkKCdwb3B1cF9vcGVuZWQnKTtcclxuICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdrZXl1cCcsIHRoaXMuX2hhbmRsZUVzY1VwKTtcclxuICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWRvd24nLCB0aGlzLl9tb3VzZUNsaWNrKTtcclxuICAgIH1cclxuXHJcbiAgICBjbG9zZSgpIHtcclxuICAgICAgICB0aGlzLl9wb3B1cEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSgncG9wdXBfb3BlbmVkJyk7XHJcbiAgICAgICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcigna2V5dXAnLCB0aGlzLl9oYW5kbGVFc2NVcCk7XHJcbiAgICAgICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcignbW91c2Vkb3duJywgdGhpcy5fbW91c2VDbGljayk7XHJcbiAgICB9XHJcblxyXG4gICAgX2hhbmRsZUVzY1VwID0gKGV2dCkgPT4ge1xyXG4gICAgICAgIGlmIChldnQua2V5ID09PSBcIkVzY2FwZVwiKSB7XHJcbiAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG5cclxuICAgIF9tb3VzZUNsaWNrID0gKGV2dCkgPT4ge1xyXG4gICAgICAgIGlmIChldnQudGFyZ2V0ID09PSB0aGlzLl9wb3B1cEVsZW1lbnQpIHtcclxuICAgICAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgICAgICB9XHJcbiAgICAgIH07ICAgIFxyXG59IiwiaW1wb3J0IFBvcHVwIGZyb20gJy4vUG9wdXAnO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoSW1hZ2UgZXh0ZW5kcyBQb3B1cCB7XHJcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvcikge1xyXG4gICAgc3VwZXIocG9wdXBTZWxlY3Rvcik7XHJcbiAgICB0aGlzLl9wcmV2aWV3SW1hZ2UgPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcclxuICAgICAgJy5wb3B1cF9faW1hZ2UnLFxyXG4gICAgKTtcclxuICAgIHRoaXMuX3ByZXZpZXdJbWFnZVRpdGxlID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgICAgICcucG9wdXBfX2NhcHRpb24nLFxyXG4gICAgKTtcclxuICB9XHJcblxyXG4gIG9wZW4oZGF0YSkge1xyXG4gICAgdGhpcy5fcHJldmlld0ltYWdlLnNyYyA9IGRhdGEuaW1hZ2U7XHJcbiAgICB0aGlzLl9wcmV2aWV3SW1hZ2UuYWx0ID0gYFBob3RvIG9mICR7ZGF0YS50aXRsZX1gO1xyXG4gICAgdGhpcy5fcHJldmlld0ltYWdlVGl0bGUudGV4dENvbnRlbnQgPSBkYXRhLnRpdGxlO1xyXG4gICAgc3VwZXIub3BlbigpO1xyXG4gIH1cclxufSIsImltcG9ydCBQb3B1cCBmcm9tICcuL1BvcHVwJztcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aEZvcm0gZXh0ZW5kcyBQb3B1cCB7XHJcbiAgY29uc3RydWN0b3IoeyBwb3B1cFNlbGVjdG9yLCBoYW5kbGVGb3JtU3VibWl0IH0pIHtcclxuICAgIHN1cGVyKHBvcHVwU2VsZWN0b3IpO1xyXG4gICAgdGhpcy5fZm9ybSA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX2Zvcm0nKTtcclxuICAgIHRoaXMuX2lucHV0TGlzdCA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKCcucG9wdXBfX2lucHV0Jyk7XHJcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24gPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcignLnBvcHVwX19zYXZlLWJ1dHRvbicpO1xyXG4gICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCA9IGhhbmRsZUZvcm1TdWJtaXQ7XHJcbiAgfVxyXG5cclxuICBnZXRJbnB1dFZhbHVlcygpIHtcclxuICAgIGNvbnN0IGlucHV0VmFsdWUgPSB7fTtcclxuICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKChpbnB1dCkgPT4ge1xyXG4gICAgICBpbnB1dFZhbHVlW2lucHV0Lm5hbWVdID0gaW5wdXQudmFsdWU7XHJcbiAgICB9KTtcclxuICAgIHJldHVybiBpbnB1dFZhbHVlO1xyXG4gIH1cclxuXHJcbiAgc2V0RXZlbnRMaXN0ZW5lcnMgPSAoKSA9PiB7XHJcbiAgICB0aGlzLl9mb3JtLmFkZEV2ZW50TGlzdGVuZXIoJ3N1Ym1pdCcsIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQpO1xyXG4gICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICB9O1xyXG5cclxuICBjbG9zZSgpIHtcclxuICAgIHN1cGVyLmNsb3NlKCk7XHJcbiAgICB0aGlzLl9mb3JtLnJlc2V0KCk7XHJcbiAgfVxyXG59IiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgVXNlckluZm8ge1xyXG4gICAgY29uc3RydWN0b3IoeyBuYW1lU2VsZWN0b3IsIGRlc2NyaXB0aW9uU2VsZWN0b3IsIGF2YXRhclNlbGVjdG9yIH0pIHtcclxuICAgICAgICB0aGlzLl9uYW1lID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihuYW1lU2VsZWN0b3IpO1xyXG4gICAgICAgIHRoaXMuX2Rlc2NyaXB0aW9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihkZXNjcmlwdGlvblNlbGVjdG9yKTtcclxuICAgICAgICB0aGlzLl9hdmF0YXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGF2YXRhclNlbGVjdG9yKTtcclxuICAgIH1cclxuXHJcbiAgICBnZXRVc2VySW5mbyA9ICgpID0+IHtcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBuYW1lOiB0aGlzLl9uYW1lLnRleHRDb250ZW50LFxyXG4gICAgICAgICAgICBkZXNjcmlwdGlvbjogdGhpcy5fZGVzY3JpcHRpb24udGV4dENvbnRlbnQsXHJcbiAgICAgICAgICAgIGF2YXRhcjogdGhpcy5fYXZhdGFyLnNyYyxcclxuICAgICAgICB9O1xyXG4gICAgfVxyXG5cclxuICAgIHNldFVzZXJJbmZvID0gKHsgbmFtZSwgZGVzY3JpcHRpb24gfSkgID0+IHtcclxuICAgICAgICB0aGlzLl9uYW1lLnRleHRDb250ZW50ID0gbmFtZTtcclxuICAgICAgICB0aGlzLl9kZXNjcmlwdGlvbi50ZXh0Q29udGVudCA9IGRlc2NyaXB0aW9uO1xyXG4gICAgICAgIHRoaXMuX2F2YXRhci5zcmMgPSBhdmF0YXI7XHJcbiAgICB9XHJcbn0iLCIvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gQ2FyZCBhcnJheSAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cclxuZXhwb3J0IGNvbnN0IGluaXRpYWxDYXJkcyA9IFtcclxuICAgIHtcclxuICAgICAgdGl0bGU6IFwiWW9zZW1pdGUgVmFsbGV5XCIsXHJcbiAgICAgIGltYWdlOiBcImh0dHBzOi8vY29kZS5zMy55YW5kZXgubmV0L3dlYi1jb2RlL3lvc2VtaXRlLmpwZ1wiXHJcbiAgICB9LFxyXG4gICAge1xyXG4gICAgICB0aXRsZTogXCJMYWtlIExvdWlzZVwiLFxyXG4gICAgICBpbWFnZTogXCJodHRwczovL2NvZGUuczMueWFuZGV4Lm5ldC93ZWItY29kZS9sYWtlLWxvdWlzZS5qcGdcIlxyXG4gICAgfSxcclxuICAgIHtcclxuICAgICAgdGl0bGU6IFwiQmFsZCBNb3VudGFpbnNcIixcclxuICAgICAgaW1hZ2U6IFwiaHR0cHM6Ly9jb2RlLnMzLnlhbmRleC5uZXQvd2ViLWNvZGUvYmFsZC1tb3VudGFpbnMuanBnXCJcclxuICAgIH0sXHJcbiAgICB7XHJcbiAgICAgIHRpdGxlOiBcIkxhdGVtYXJcIixcclxuICAgICAgaW1hZ2U6IFwiaHR0cHM6Ly9jb2RlLnMzLnlhbmRleC5uZXQvd2ViLWNvZGUvbGF0ZW1hci5qcGdcIlxyXG4gICAgfSxcclxuICAgIHtcclxuICAgICAgdGl0bGU6IFwiVmFub2lzZSBOYXRpb25hbCBQYXJrXCIsXHJcbiAgICAgIGltYWdlOiBcImh0dHBzOi8vY29kZS5zMy55YW5kZXgubmV0L3dlYi1jb2RlL3Zhbm9pc2UuanBnXCJcclxuICAgIH0sXHJcbiAgICB7XHJcbiAgICAgIHRpdGxlOiBcIkxhZ28gZGkgQnJhaWVzXCIsXHJcbiAgICAgIGltYWdlOiBcImh0dHBzOi8vY29kZS5zMy55YW5kZXgubmV0L3dlYi1jb2RlL2xhZ28uanBnXCJcclxuICAgIH1cclxuICBdO1xyXG5cclxuICBleHBvcnQgY29uc3QgZm9ybVZhbGlkYXRpb25TZXR0aW5ncyA9IHtcclxuICAgIGlucHV0U2VsZWN0b3I6IFwiLnBvcHVwX19pbnB1dFwiLFxyXG4gICAgc3VibWl0QnV0dG9uU2VsZWN0b3I6IFwiLnBvcHVwX19zYXZlLWJ1dHRvblwiLFxyXG4gICAgaW5hY3RpdmVCdXR0b25DbGFzczogXCJwb3B1cF9fc2F2ZS1idXR0b25fdHlwZV9kaXNhYmxlZFwiLFxyXG4gICAgaW5wdXRFcnJvckNsYXNzOiBcInBvcHVwX19pbnB1dF90eXBlX2Vycm9yXCIsXHJcbiAgICBlcnJvckNsYXNzOiBcInBvcHVwX19lcnJvcl92aXNpYmxlXCIsXHJcbiAgfTtcclxuXHJcbiAgZXhwb3J0IGNvbnN0IHNlbGVjdG9ycyA9IHtcclxuICAgICAgY2FyZFNlY3Rpb246ICcucGxhY2VzX19saXN0JyxcclxuICAgICAgY2FyZFRlbXBsYXRlOiAnI2NhcmRUZW1wbGF0ZScsXHJcbiAgICAgIHByZXZpZXdQb3B1cDogJy5wb3B1cF90eXBlX3ByZXZpZXcnLFxyXG4gICAgICBcclxuICAgICAgYWRkTW9kYWw6IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfdHlwZV9hZGRcIiksXHJcbiAgfTtcclxuXHJcbiAgZXhwb3J0IGNvbnN0IHBvcHVwRWRpdFVzZXIgPSB7XHJcbiAgICBlZGl0TW9kYWw6IFwiLnBvcHVwX3R5cGVfZWRpdFwiLFxyXG4gICAgbmFtZVNlbGVjdG9yOiBcIi5wcm9maWxlX19uYW1lXCIsXHJcbiAgICBkZXNjcmlwdGlvblNlbGVjdG9yOiBcIi5wcm9maWxlX19kZXNjcmlwdGlvblwiLFxyXG4gICAgZWRpdEJ1dHRvbjogZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19lZGl0LWJ1dHRvblwiKSxcclxuICAgIGNsb3NlQnV0dG9uOiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19jbG9zZS1idXR0b25cIiksXHJcbiAgfVxyXG5cclxuICBleHBvcnQgY29uc3QgcG9wdXBFZGl0QXZhdGFyID0ge1xyXG4gICAgc2VsZWN0b3I6ICcucG9wdXBfdHlwZV9hdmF0YXInLFxyXG4gICAgYXZhdGFyU2VsZWN0b3I6ICcucHJvZmlsZV9faW1hZ2UnLFxyXG4gICAgYnV0dG9uOiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvZmlsZV9fYXZhdGFyJyksXHJcbiAgICBmb3JtOiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubW9kYWxfdHlwZV9hdmF0YXIgLm1vZGFsX19mb3JtJyksXHJcbiAgICBhdmF0YXJJbnB1dDogZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI2F2YXRhci1pbnB1dCcpLFxyXG4gIH07ICBcclxuXHJcbiAgZXhwb3J0IGNvbnN0IHBvcHVwQWRkQ2FyZCA9IHtcclxuICAgIGFkZE1vZGFsOiBcIi5wb3B1cF90eXBlX2FkZFwiLFxyXG4gICAgYWRkQnV0dG9uOiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvZmlsZV9fYWRkLWJ1dHRvbicpLFxyXG4gICAgY2xvc2VCdXR0b246IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX2Nsb3NlLWJ1dHRvblwiKSxcclxuICB9XHJcblxyXG5cclxuICIsImNsYXNzIEFwaSB7XHJcbiAgY29uc3RydWN0b3IoeyBiYXNlVXJsLCBoZWFkZXJzIH0pIHtcclxuICAgIHRoaXMuX2Jhc2VVcmwgPSBiYXNlVXJsO1xyXG4gICAgdGhpcy5faGVhZGVycyA9IGhlYWRlcnM7XHJcbiAgfVxyXG5cclxuICBfY2hlY2tSZXNwb25zZShyZXMpIHtcclxuICAgIGlmIChyZXMub2spIHtcclxuICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yICR7cmVzLnN0YXR1c31gKTtcclxuICB9XHJcblxyXG4gIGdldEFwcEluZm8oKSB7XHJcbiAgICByZXR1cm4gUHJvbWlzZS5hbGwoW3RoaXMuZ2V0Q2FyZExpc3QoKSwgdGhpcy5nZXRVc2VySW5mbygpXSk7XHJcbiAgfVxyXG5cclxuICBnZXRJbml0aWFsQ2FyZHMoKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHNgLCB7XHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICB9KS50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xyXG4gIH1cclxuXHJcbiAgZ2V0VXNlckluZm8oKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWVgLCB7XHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICB9KS50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xyXG4gIH1cclxuXHJcbiAgc2V0VXNlckluZm8oeyBuYW1lLCBhYm91dCB9KSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWVgLCB7XHJcbiAgICAgIG1ldGhvZDogJ1BBVENIJyxcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoeyBuYW1lLCBhYm91dCB9KSxcclxuICAgIH0pLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XHJcbiAgfVxyXG5cclxuXHJcbiAgYWRkQ2FyZCh7IG5hbWUsIGxpbmsgfSkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzYCwge1xyXG4gICAgICBtZXRob2Q6ICdQT1NUJyxcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoeyBuYW1lLCBsaW5rIH0pLFxyXG4gICAgfSkudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcclxuICB9XHJcblxyXG4gIHJlbW92ZUNhcmQoY2FyZElEKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvJHtjYXJkSUR9YCwge1xyXG4gICAgICBtZXRob2Q6ICdERUxFVEUnLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgfSkudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcclxuICB9XHJcblxyXG4gIGFkZExpa2UoY2FyZElEKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvbGlrZXMvJHtjYXJkSUR9YCwge1xyXG4gICAgICBtZXRob2Q6ICdQVVQnLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgfSkudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcclxuICB9XHJcblxyXG4gIHJlbW92ZUxpa2UoY2FyZElEKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvbGlrZXMvJHtjYXJkSUR9YCwge1xyXG4gICAgICBtZXRob2Q6ICdERUxFVEUnLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgfSkudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcclxuICB9XHJcblxyXG5cclxuICBzZXRVc2VyQXZhdGFyKHsgYXZhdGFyIH0pIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZS9hdmF0YXJgLCB7XHJcbiAgICAgIG1ldGhvZDogJ1BBVENIJyxcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoeyBhdmF0YXIgfSksXHJcbiAgICB9KS50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xyXG4gIH1cclxuXHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IEFwaTsiLCJleHBvcnQgY29uc3QgcmVuZGVyTG9hZGluZyA9IChwb3B1cFNlbGVjdG9yLCBpc0xvYWRpbmcgPSBmYWxzZSkgPT4ge1xyXG4gICAgY29uc3QgYWN0aXZlQnV0dG9uID0gZG9jdW1lbnRcclxuICAgICAgLnF1ZXJ5U2VsZWN0b3IocG9wdXBTZWxlY3RvcilcclxuICAgICAgLnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX3NhdmUtYnV0dG9uXCIpO1xyXG4gICAgaWYgKGlzTG9hZGluZykge1xyXG4gICAgICBhY3RpdmVCdXR0b24udGV4dENvbnRlbnQgPSBcIlNhdmluZy4uLlwiO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgYWN0aXZlQnV0dG9uLnRleHRDb250ZW50ID0gXCJTYXZlXCI7XHJcbiAgICB9XHJcbiAgfTsiLCJpbXBvcnQgXCIuL2luZGV4LmNzc1wiO1xyXG5cclxuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cclxuLyogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgSW1wb3J0IGNsYXNzZXMgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKi9cclxuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cclxuaW1wb3J0IEZvcm1WYWxpZGF0b3IgZnJvbSBcIi4uL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qc1wiO1xyXG5pbXBvcnQgQ2FyZCBmcm9tIFwiLi4vY29tcG9uZW50cy9DYXJkLmpzXCI7XHJcbmltcG9ydCBTZWN0aW9uIGZyb20gXCIuLi9jb21wb25lbnRzL1NlY3Rpb24uanNcIjtcclxuaW1wb3J0IFBvcHVwV2l0aEltYWdlIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzXCI7XHJcbmltcG9ydCBQb3B1cFdpdGhGb3JtIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanNcIjtcclxuaW1wb3J0IFBvcHVwV2l0aENvbmZpcm1hdGlvbiBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhDb25maXJtYXRpb24uanNcIjtcclxuaW1wb3J0IFVzZXJJbmZvIGZyb20gXCIuLi9jb21wb25lbnRzL1VzZXJJbmZvLmpzXCI7XHJcbmltcG9ydCB7IGZvcm1WYWxpZGF0aW9uU2V0dGluZ3MsIHNlbGVjdG9ycywgcG9wdXBFZGl0VXNlciwgcG9wdXBFZGl0QXZhdGFyLCBwb3B1cEFkZENhcmQsIGluaXRpYWxDYXJkcyB9IGZyb20gXCIuLi91dGlscy9jb25zdGFudHMuanNcIjtcclxuaW1wb3J0IEFwaSBmcm9tIFwiLi4vY29tcG9uZW50cy9BcGkuanNcIjtcclxuaW1wb3J0IHsgcmVuZGVyTG9hZGluZyB9IGZyb20gXCIuLi91dGlscy91dGlscy5qc1wiO1xyXG5cclxuXHJcbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXHJcbi8qICAgICAgICAgICAgICAgICAgICAgICBDcmVhdGUgaW5zdGFuY2VzIG9mIHRoZSBjbGFzc2VzICAgICAgICAgICAgICAgICAgICAgICovXHJcbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXHJcbmNvbnN0IHVzZXJJbmZvID0gbmV3IFVzZXJJbmZvKHtcclxuICBuYW1lU2VsZWN0b3I6IHBvcHVwRWRpdFVzZXIubmFtZVNlbGVjdG9yLFxyXG4gIGRlc2NyaXB0aW9uU2VsZWN0b3I6IHBvcHVwRWRpdFVzZXIuZGVzY3JpcHRpb25TZWxlY3RvcixcclxuICBhdmF0YXJTZWxlY3RvcjogcG9wdXBFZGl0QXZhdGFyLmF2YXRhclNlbGVjdG9yLFxyXG59KTtcclxuXHJcbmNvbnN0IGNhcmRQcmV2aWV3UG9wdXAgPSBuZXcgUG9wdXBXaXRoSW1hZ2Uoc2VsZWN0b3JzLnByZXZpZXdQb3B1cCk7XHJcbmNhcmRQcmV2aWV3UG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXHJcbi8qICAgICAgICAgICAgICAgICAgV29ya2luZyBvbiB1c2VyIHByb2ZpbGUgYW5kIGF2YXRhciBlZGl0cyAgICAgICAgICAgICAgICAgICovXHJcbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXHJcbmNvbnN0IGVkaXRGb3JtID0gbmV3IFBvcHVwV2l0aEZvcm0oe1xyXG4gIHBvcHVwU2VsZWN0b3I6IFwiLnBvcHVwX3R5cGVfZWRpdFwiLFxyXG4gIGhhbmRsZUZvcm1TdWJtaXQ6IChkYXRhKSA9PiB7XHJcbiAgICByZW5kZXJMb2FkaW5nKFwiLnBvcHVwX3R5cGVfZWRpdFwiLCB0cnVlKTtcclxuICAgIGFwaVxyXG4gICAgICAuZ2V0VXNlckluZm8oe1xyXG4gICAgICAgIG5hbWU6IGRhdGEucHJvZmlsZU5hbWUsXHJcbiAgICAgICAgYWJvdXQ6IGRhdGEucHJvZmlsZURlc2NyaXB0aW9uLFxyXG4gICAgICB9KVxyXG4gICAgICAudGhlbigoaW5mbykgPT4ge1xyXG4gICAgICAgIHVzZXJJbmZvLnNldFVzZXJJbmZvKHtcclxuICAgICAgICAgIHByb2ZpbGVOYW1lOiBpbmZvLm5hbWUsXHJcbiAgICAgICAgICBwcm9maWxlRGVzY3JpcHRpb246IGluZm8uYWJvdXQsXHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgZWRpdEZvcm0uY2xvc2VNb2RhbCgpO1xyXG4gICAgICB9KVxyXG4gICAgICAuY2F0Y2goKGVycikgPT5cclxuICAgICAgICBjb25zb2xlLndhcm4oYFVuYWJsZSB0byB1cGRhdGUgcHJvZmlsZSBpbmZvcm1hdGlvbjogJHtlcnJ9YClcclxuICAgICAgKVxyXG4gICAgICAuZmluYWxseSgoKSA9PiB7XHJcbiAgICAgICAgcmVuZGVyTG9hZGluZyhcIi5wb3B1cF90eXBlX2VkaXRcIik7XHJcbiAgICAgIH0pO1xyXG4gIH0sXHJcbn0pO1xyXG5cclxuY29uc3QgYWRkRm9ybSA9IG5ldyBQb3B1cFdpdGhGb3JtKHtcclxuICBwb3B1cFNlbGVjdG9yOiBcIi5wb3B1cF90eXBlX2FkZFwiLFxyXG4gIGhhbmRsZUZvcm1TdWJtaXQ6IChkYXRhKSA9PiB7XHJcbiAgICByZW5kZXJMb2FkaW5nKFwiLnBvcHVwX3R5cGVfYWRkXCIsIHRydWUpO1xyXG4gICAgYXBpXHJcbiAgICAgIC5hZGRDYXJkKGRhdGEpXHJcbiAgICAgIC50aGVuKChjYXJkRGF0YSkgPT4ge1xyXG4gICAgICAgIGNhcmRTZWN0aW9uLmFkZEl0ZW0oY3JlYXRlQ2FyZChjYXJkRGF0YSkpO1xyXG4gICAgICAgIGFkZEZvcm0uY2xvc2VNb2RhbCgpO1xyXG4gICAgICAgIGNvbnNvbGUubG9nKGNhcmREYXRhKTtcclxuICAgICAgfSlcclxuICAgICAgLmNhdGNoKChlcnIpID0+IGNvbnNvbGUuZXJyb3IoYFVuYWJsZSB0byBhZGQgYSBjYXJkOiAke2Vycn1gKSlcclxuICAgICAgLmZpbmFsbHkoKCkgPT4ge1xyXG4gICAgICAgIHJlbmRlckxvYWRpbmcoXCIucG9wdXBfdHlwZV9hZGRcIik7XHJcbiAgICAgIH0pO1xyXG4gIH0sXHJcbn0pO1xyXG5cclxuXHJcbi8vIGFkZENhcmRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuLy8gICBhZGRDYXJkUG9wdXAub3Blbk1vZGFsKCk7XHJcbi8vICAgYWRkQ2FyZFZhbGlkYXRvci50b2dnbGVCdXR0b25TdGF0ZSgpO1xyXG4vLyB9KTtcclxuXHJcblxyXG4vLyBjb25zdCBwb3B1cEVkaXRBdmF0YXJGb3JtID0gbmV3IFBvcHVwV2l0aEZvcm0oXHJcbi8vICAgcG9wdXBFZGl0QXZhdGFyLnNlbGVjdG9yLFxyXG4vLyAgIHsgZGVmYXVsdFRleHQ6ICdTYXZlJywgdXBkYXRpbmdUZXh0OiAnU2F2aW5nLi4uJyB9LFxyXG4vLyAgIChmb3JtSW5wdXQpID0+XHJcbi8vICAgICBhcGlcclxuLy8gICAgICAgLnNldFVzZXJBdmF0YXIoeyBhdmF0YXI6IGZvcm1JbnB1dC5saW5rIH0pXHJcbi8vICAgICAgIC50aGVuKChkYXRhKSA9PiB7XHJcbi8vICAgICAgICAgdXNlckluZm8uc2V0VXNlckluZm8oe1xyXG4vLyAgICAgICAgICAgbmFtZTogZGF0YS5uYW1lLFxyXG4vLyAgICAgICAgICAgYWJvdXQ6IGRhdGEuYWJvdXQsXHJcbi8vICAgICAgICAgICBhdmF0YXI6IGRhdGEuYXZhdGFyLFxyXG4vLyAgICAgICAgIH0pO1xyXG4vLyAgICAgICB9KVxyXG4vLyAgICAgICAuY2F0Y2goKGVycikgPT4ge1xyXG4vLyAgICAgICAgIGNvbnNvbGUubG9nKGVycik7XHJcbi8vICAgICAgIH0pLFxyXG4vLyApO1xyXG4vLyBwb3B1cEVkaXRBdmF0YXJGb3JtLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG4vLyBcclxuXHJcblxyXG5cclxuXHJcbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXHJcbi8qICAgICAgICAgICAgICAgICAgIERpc2FibGVkIHRvIHRyb3VibGVzaG9vdCB1c2VyIGVkaXQgZm9ybSAgICAgICAgICAgICAgICAgICovXHJcbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXHJcbi8vIGNvbnN0IGNyZWF0ZUNhcmQgPSAoY2FyZCkgPT5cclxuLy8gbmV3IENhcmQoe1xyXG4vLyBkYXRhOmNhcmQsIGhhbmRsZUNhcmRDbGljazogKGltYWdlRGF0YSkgPT4ge1xyXG4vLyBjYXJkUHJldmlld1BvcHVwLm9wZW4oaW1hZ2VEYXRhKTtcclxuLy8gfSxcclxuLy8gfSxcclxuLy8gc2VsZWN0b3JzLmNhcmRUZW1wbGF0ZSxcclxuLy8gKTtcclxuXHJcbi8vIGNvbnN0IGNhcmRTZWN0aW9uID0gbmV3IFNlY3Rpb24oe1xyXG4vLyAgcmVuZGVyZXI6IChpdGVtKSA9PiB7XHJcbi8vICBjb25zdCBjYXJkRWxlbWVudCA9IGNyZWF0ZUNhcmQoaXRlbSk7XHJcbi8vICBjYXJkU2VjdGlvbi5hZGRJdGVtKGNhcmRFbGVtZW50LmdldFZpZXcoKSk7XHJcbi8vICB9LFxyXG4vLyB9LFxyXG4vLyAgc2VsZWN0b3JzLmNhcmRTZWN0aW9uLFxyXG4vLyApO1xyXG4vLyBjYXJkU2VjdGlvbi5yZW5kZXJJdGVtcyhpbml0aWFsQ2FyZHMpO1xyXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xyXG4vKiAgICAgICAgICAgICAgICAgICBEaXNhYmxlZCB0byB0cm91Ymxlc2hvb3QgdXNlciBlZGl0IGZvcm0gICAgICAgICAgICAgICAgICAqL1xyXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xyXG5cclxuXHJcblxyXG5lZGl0Rm9ybS5zZXRFdmVudExpc3RlbmVycygpO1xyXG5hZGRGb3JtLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xyXG4vKiAgICAgICAgICAgICAgICAgICAgICAgUHJlZmlsbCBmdW5jdGlvbiBhbmQgY29uc3RhbnRzICAgICAgICAgICAgICAgICAgICAgICAqL1xyXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xyXG5mdW5jdGlvbiBwcmVmaWxsRWRpdEZvcm0obW9kYWxXaW5kb3cpIHtcclxuICBjb25zdCB7IG5hbWUsIGRlc2NyaXB0aW9uIH0gPSB1c2VySW5mby5nZXRVc2VySW5mbygpO1xyXG4gIG5hbWVJbnB1dC52YWx1ZSA9IG5hbWU7XHJcbiAgZGVzY3JpcHRpb25JbnB1dC52YWx1ZSA9IGRlc2NyaXB0aW9uO1xyXG59XHJcblxyXG4vLyBjb25zdCBwcm9maWxlTmFtZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fbmFtZVwiKTtcclxuLy8gY29uc3QgcHJvZmlsZUFib3V0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19kZXNjcmlwdGlvblwiKTtcclxuXHJcbmNvbnN0IG5hbWVJbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjb3duZXItbmFtZVwiKTtcclxuY29uc3QgZGVzY3JpcHRpb25JbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjb3duZXItZGVzY3JpcHRpb25cIik7XHJcblxyXG5jb25zdCBhcGkgPSBuZXcgQXBpKHtcclxuICBiYXNlVXJsOiAnaHR0cHM6Ly9hcm91bmQubm9tb3JlcGFydGllcy5jby92MS9ncm91cC0xMicsXHJcbiAgaGVhZGVyczoge1xyXG4gICAgYXV0aG9yaXphdGlvbjogJ2FjY2E5ZGQzLWE2YTQtNDYyNi04OGUyLTYwNjE5NjAyYmRmOScsXHJcbiAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLFxyXG4gIH0sXHJcbn0pO1xyXG5cclxuXHJcbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXHJcbi8qICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEV2ZW50IGxpc3RlbmVycyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICovXHJcbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXHJcbnBvcHVwRWRpdFVzZXIuZWRpdEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gIHByZWZpbGxFZGl0Rm9ybShlZGl0Rm9ybSk7XHJcbiAgZWRpdEZvcm0ub3BlbigpO1xyXG59KTtcclxuXHJcbi8vIGVkaXRQcm9maWxlQ2xvc2VCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IGVkaXRQb3B1cC5jbG9zZSgpKTtcclxuXHJcbnBvcHVwQWRkQ2FyZC5hZGRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICBhZGRGb3JtLm9wZW4oKTtcclxufSk7XHJcblxyXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xyXG4vKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFZhbGlkYXRpb24gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqL1xyXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xyXG5cclxuY29uc3QgZWRpdEZvcm1FbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF90eXBlX2VkaXQnKTtcclxuY29uc3QgYWRkRm9ybUVsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBvcHVwX3R5cGVfYWRkJyk7XHJcblxyXG5jb25zdCBlZGl0Rm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKGZvcm1WYWxpZGF0aW9uU2V0dGluZ3MsIGVkaXRGb3JtRWwpO1xyXG5lZGl0Rm9ybVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XHJcblxyXG5jb25zdCBhZGRGb3JtVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IoZm9ybVZhbGlkYXRpb25TZXR0aW5ncywgYWRkRm9ybUVsKTtcclxuYWRkRm9ybVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XHJcblxyXG5cclxuXHJcblxyXG5cclxuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cclxuLyogICAgICAgICAgICAgICAgICAgICAgICAgICAgT2xkIGVkaXRGb3JtIHJvdXRpbmUsIHdpbGwgYmUgZGVsZXRlZCAgICAgICAgICAgKi9cclxuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cclxuLy8gY29uc3QgZWRpdEZvcm0gPSBuZXcgUG9wdXBXaXRoRm9ybShcclxuICAvLyBwb3B1cEVkaXRVc2VyLmVkaXRNb2RhbCxcclxuICAvLyAoZXZ0KSA9PiB7XHJcbiAgICAvLyBldnQucHJldmVudERlZmF1bHQoKTtcclxuLy9cclxuICAgIC8vIGNvbnN0IGlucHV0VmFsdWUgPSBlZGl0Rm9ybS5nZXRJbnB1dFZhbHVlcygpO1xyXG4gICAgLy8gdXNlckluZm8uc2V0VXNlckluZm8oe1xyXG4gICAgICAvLyBuYW1lOiBpbnB1dFZhbHVlLm5hbWUsXHJcbiAgICAgIC8vIGRlc2NyaXB0aW9uOiBpbnB1dFZhbHVlLmRlc2NyaXB0aW9uLFxyXG4gICAgLy8gfSk7XHJcblxyXG4gICAgLy8gZWRpdEZvcm0uY2xvc2UoKTtcclxuICAgIC8vIGVkaXRGb3JtVmFsaWRhdG9yLnJlc2V0VmFsaWRhdGlvbigpO1xyXG4gIC8vIH0sXHJcbi8vICk7XHJcbi8vIGVkaXRGb3JtLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiJdLCJuYW1lcyI6WyJGb3JtVmFsaWRhdG9yIiwic2V0dGluZ3MiLCJmb3JtRWxlbWVudCIsInRoaXMiLCJfaW5wdXRTZWxlY3RvciIsImlucHV0U2VsZWN0b3IiLCJfc3VibWl0QnV0dG9uU2VsZWN0b3IiLCJzdWJtaXRCdXR0b25TZWxlY3RvciIsIl9pbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiaW5hY3RpdmVCdXR0b25DbGFzcyIsIl9pbnB1dEVycm9yQ2xhc3MiLCJpbnB1dEVycm9yQ2xhc3MiLCJfZXJyb3JDbGFzcyIsImVycm9yQ2xhc3MiLCJfaW5wdXRMaXN0IiwicXVlcnlTZWxlY3RvckFsbCIsIl9idXR0b25FbCIsInF1ZXJ5U2VsZWN0b3IiLCJfZm9ybUVsZW1lbnQiLCJpbnB1dEVsIiwiZXJyb3JFbCIsImlkIiwiY2xhc3NMaXN0IiwiYWRkIiwidGV4dENvbnRlbnQiLCJ2YWxpZGF0aW9uTWVzc2FnZSIsInJlbW92ZSIsInZhbGlkaXR5IiwidmFsaWQiLCJfaGlkZUlucHV0RXJyb3IiLCJfc2hvd0lucHV0RXJyb3IiLCJldmVyeSIsImRpc2FibGVkIiwidG9nZ2xlQnV0dG9uU3RhdGUiLCJmb3JFYWNoIiwiYWRkRXZlbnRMaXN0ZW5lciIsImUiLCJfY2hlY2tJbnB1dFZhbGlkaXR5IiwiZXZ0IiwicHJldmVudERlZmF1bHQiLCJfc2V0dXBFdmVudExpc3RlbmVycyIsImlucHV0RWxlbWVudCIsIlBvcHVwIiwicG9wdXBTZWxlY3RvciIsImtleSIsImNsb3NlIiwidGFyZ2V0IiwiX3BvcHVwRWxlbWVudCIsImRvY3VtZW50IiwiX2hhbmRsZUVzY1VwIiwiYmluZCIsIl9tb3VzZUNsaWNrIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsIlBvcHVwV2l0aEltYWdlIiwiX3ByZXZpZXdJbWFnZSIsIl9wcmV2aWV3SW1hZ2VUaXRsZSIsImRhdGEiLCJzcmMiLCJpbWFnZSIsImFsdCIsInRpdGxlIiwiUG9wdXBXaXRoRm9ybSIsImhhbmRsZUZvcm1TdWJtaXQiLCJfZm9ybSIsIl9oYW5kbGVGb3JtU3VibWl0IiwiX3N1Ym1pdEJ1dHRvbiIsImlucHV0VmFsdWUiLCJpbnB1dCIsIm5hbWUiLCJ2YWx1ZSIsInJlc2V0IiwiVXNlckluZm8iLCJuYW1lU2VsZWN0b3IiLCJkZXNjcmlwdGlvblNlbGVjdG9yIiwiYXZhdGFyU2VsZWN0b3IiLCJfbmFtZSIsImRlc2NyaXB0aW9uIiwiX2Rlc2NyaXB0aW9uIiwiYXZhdGFyIiwiX2F2YXRhciIsImZvcm1WYWxpZGF0aW9uU2V0dGluZ3MiLCJwb3B1cEVkaXRVc2VyIiwiZWRpdE1vZGFsIiwiZWRpdEJ1dHRvbiIsImNsb3NlQnV0dG9uIiwicG9wdXBBZGRDYXJkIiwiYWRkTW9kYWwiLCJhZGRCdXR0b24iLCJBcGkiLCJiYXNlVXJsIiwiaGVhZGVycyIsIl9iYXNlVXJsIiwiX2hlYWRlcnMiLCJyZXMiLCJvayIsImpzb24iLCJQcm9taXNlIiwicmVqZWN0Iiwic3RhdHVzIiwiYWxsIiwiZ2V0Q2FyZExpc3QiLCJnZXRVc2VySW5mbyIsImZldGNoIiwidGhlbiIsIl9jaGVja1Jlc3BvbnNlIiwiYWJvdXQiLCJtZXRob2QiLCJib2R5IiwiSlNPTiIsInN0cmluZ2lmeSIsImxpbmsiLCJjYXJkSUQiLCJyZW5kZXJMb2FkaW5nIiwiaXNMb2FkaW5nIiwiYWN0aXZlQnV0dG9uIiwidXNlckluZm8iLCJzZXRFdmVudExpc3RlbmVycyIsImVkaXRGb3JtIiwiYXBpIiwicHJvZmlsZU5hbWUiLCJwcm9maWxlRGVzY3JpcHRpb24iLCJpbmZvIiwic2V0VXNlckluZm8iLCJjbG9zZU1vZGFsIiwiY2F0Y2giLCJlcnIiLCJjb25zb2xlIiwid2FybiIsImZpbmFsbHkiLCJhZGRGb3JtIiwiYWRkQ2FyZCIsImNhcmREYXRhIiwiY2FyZFNlY3Rpb24iLCJhZGRJdGVtIiwiY3JlYXRlQ2FyZCIsImxvZyIsImVycm9yIiwibmFtZUlucHV0IiwiZGVzY3JpcHRpb25JbnB1dCIsImF1dGhvcml6YXRpb24iLCJvcGVuIiwiZWRpdEZvcm1FbCIsImFkZEZvcm1FbCIsImVuYWJsZVZhbGlkYXRpb24iXSwic291cmNlUm9vdCI6IiJ9